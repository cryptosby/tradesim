<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Trade Sim - Advanced Cryptos Trading Simulator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            margin: 0;
            background: #0e1116;
            color: #fff;
        }
        header {
            background-color: #1e2228;
            padding: 1em;
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            position: relative;
        }
        .container {
            padding: 20px;
        }
        .controls, .actions {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }
        select, input, button {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            font-size: 0.9em;
        }
        button {
            background-color: #3a8dd8;
            color: #fff;
            cursor: pointer;
            min-width: 80px;
        }
        button:hover {
            background-color: #337ac4;
        }
        #buy-btn {
            background-color: #00aa5e;
        }
        #sell-btn {
            background-color: #ff4d4d;
        }
        .chart {
            width: 100%;
            height: 500px;
            margin-bottom: 30px;
        }
        .balance, .profit-loss, .timer {
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        .profit { color: #00ff9f; }
        .loss { color: #ff4d4d; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
            background: #1e222d;
        }
        th, td {
            padding: 10px;
            text-align: center;
            border: 1px solid #333;
        }
        th {
            background-color: #2c313a;
        }
        .exchange-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        .exchange-card {
            background: #1e2228;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            transition: transform 0.2s;
        }
        .exchange-card:hover {
            transform: translateY(-3px);
        }
        .exchange-logo {
            height: 30px;
            margin-bottom: 5px;
        }
        .news-popup {
            position: relative;
            display: inline-block;
            margin: 20px auto;
            text-align: center;
            width: 100%;
        }
        .news-popup button {
            background: linear-gradient(135deg, #3a8dd8, #2c5f9e);
            padding: 12px 24px;
            font-size: 1.1em;
            border-radius: 30px;
            box-shadow: 0 4px 15px rgba(58, 141, 216, 0.3);
            transition: all 0.3s ease;
        }
        .news-popup button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(58, 141, 216, 0.4);
        }
        .news-popup-content {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            background: #1e222d;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            z-index: 1;
        }
        .news-popup:hover .news-popup-content {
            display: block;
        }
        footer {
            background: #1e2228;
            padding: 20px;
            text-align: center;
            margin-top: 30px;
        }
        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 15px;
        }
        .footer-links a {
            color: #3a8dd8;
            text-decoration: none;
        }
        .ad-banner {
            width: 100%;
            margin: 20px 0;
            text-align: center;
            background: #1e2228;
            padding: 10px;
            border-radius: 5px;
        }
        .header-banner {
            height: 90px;
        }
        .top-banner {
            height: 60px;
        }
        .middle-banner {
            height: 90px;
        }
        .bottom-banner {
            height: 90px;
        }
        .amazon-affiliate {
            margin: 20px auto;
            text-align: center;
        }
        .amazon-btn {
            background: linear-gradient(135deg, #FF9900, #FFAC33);
            color: #000;
            padding: 12px 24px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .amazon-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 153, 0, 0.3);
        }
        .exchange-name {
            color: #00b4ff;
            font-weight: bold;
            margin: 5px 0;
        }
        .exchange-fiat {
            color: #ffff00;
            font-size: 0.8em;
            margin: 5px 0;
        }
        .exchange-signup {
            color: #fff;
            font-size: 0.9em;
            margin: 5px 0;
        }
    </style>
</head>
<body>
<header>
    TradeSim 
    <div class="ad-banner header-banner">
        <!-- Header Banner (728x90) -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
             crossorigin="anonymous"></script>
        <!-- CryptoSim_Header -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
</header>

<div class="container">
    <div class="ad-banner top-banner">
        <!-- Top Content Banner (468x60) -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
             crossorigin="anonymous"></script>
        <!-- CryptoSim_Top -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:468px;height:60px"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <div class="balance">Balance: $<span id="balance">100000.00</span></div>
    <div class="profit-loss" id="profit-loss"></div>
    <div class="timer" id="timer">Timer: 0s</div>

    <div class="controls">
        <label for="crypto-select">Select Coin:</label>
        <select id="crypto-select">
            <!-- Top 100 Cryptocurrencies by Market Cap -->
            <option value="BINANCE:BTCUSDT">Bitcoin (BTC)</option>
            <option value="BINANCE:ETHUSDT">Ethereum (ETH)</option>
            <option value="BINANCE:BNBUSDT">Binance Coin (BNB)</option>
            <option value="BINANCE:XRPUSDT">XRP (XRP)</option>
            <option value="BINANCE:SOLUSDT">Solana (SOL)</option>
            <option value="BINANCE:ADAUSDT">Cardano (ADA)</option>
            <option value="BINANCE:DOGEUSDT">Dogecoin (DOGE)</option>
            <option value="BINANCE:TRXUSDT">TRON (TRX)</option>
            <option value="BINANCE:DOTUSDT">Polkadot (DOT)</option>
            <option value="BINANCE:MATICUSDT">Polygon (MATIC)</option>
            <option value="BINANCE:LTCUSDT">Litecoin (LTC)</option>
            <option value="BINANCE:SHIBUSDT">Shiba Inu (SHIB)</option>
            <option value="BINANCE:AVAXUSDT">Avalanche (AVAX)</option>
            <option value="BINANCE:LINKUSDT">Chainlink (LINK)</option>
            <option value="BINANCE:ATOMUSDT">Cosmos (ATOM)</option>
            <option value="BINANCE:UNIUSDT">Uniswap (UNI)</option>
            <option value="BINANCE:XLMUSDT">Stellar (XLM)</option>
            <option value="BINANCE:XMRUSDT">Monero (XMR)</option>
            <option value="BINANCE:ETCUSDT">Ethereum Classic (ETC)</option>
            <option value="BINANCE:ICPUSDT">Internet Computer (ICP)</option>
            <option value="BINANCE:FILUSDT">Filecoin (FIL)</option>
            <option value="BINANCE:APTUSDT">Aptos (APT)</option>
            <option value="BINANCE:HBARUSDT">Hedera (HBAR)</option>
            <option value="BINANCE:NEARUSDT">NEAR Protocol (NEAR)</option>
            <option value="BINANCE:VETUSDT">VeChain (VET)</option>
            <option value="BINANCE:ARBUSDT">Arbitrum (ARB)</option>
            <option value="BINANCE:OPUSDT">Optimism (OP)</option>
            <option value="BINANCE:GRTUSDT">The Graph (GRT)</option>
            <option value="BINANCE:AAVEUSDT">Aave (AAVE)</option>
            <option value="BINANCE:ALGOUSDT">Algorand (ALGO)</option>
            <option value="BINANCE:STXUSDT">Stacks (STX)</option>
            <option value="BINANCE:QNTUSDT">Quant (QNT)</option>
            <option value="BINANCE:EOSUSDT">EOS (EOS)</option>
            <option value="BINANCE:FLOWUSDT">Flow (FLOW)</option>
            <option value="BINANCE:THETAUSDT">Theta Network (THETA)</option>
            <option value="BINANCE:XTZUSDT">Tezos (XTZ)</option>
            <option value="BINANCE:AXSUSDT">Axie Infinity (AXS)</option>
            <option value="BINANCE:RNDRUSDT">Render (RNDR)</option>
            <option value="BINANCE:SNXUSDT">Synthetix (SNX)</option>
            <option value="BINANCE:APEUSDT">ApeCoin (APE)</option>
            <option value="BINANCE:CHZUSDT">Chiliz (CHZ)</option>
            <option value="BINANCE:MANAUSDT">Decentraland (MANA)</option>
            <option value="BINANCE:CRVUSDT">Curve DAO (CRV)</option>
            <option value="BINANCE:KAVAUSDT">Kava (KAVA)</option>
            <option value="BINANCE:IMXUSDT">Immutable X (IMX)</option>
            <option value="BINANCE:1INCHUSDT">1inch (1INCH)</option>
            <option value="BINANCE:COMPUSDT">Compound (COMP)</option>
            <option value="BINANCE:ZECUSDT">Zcash (ZEC)</option>
            <option value="BINANCE:GMTUSDT">STEPN (GMT)</option>
            <option value="BINANCE:DASHUSDT">Dash (DASH)</option>
            <option value="BINANCE:KLAYUSDT">Klaytn (KLAY)</option>
            <option value="BINANCE:ENSUSDT">Ethereum Name Service (ENS)</option>
            <option value="BINANCE:WAVESUSDT">Waves (WAVES)</option>
            <option value="BINANCE:CVXUSDT">Convex Finance (CVX)</option>
            <option value="BINANCE:GMXUSDT">GMX (GMX)</option>
            <option value="BINANCE:GALAUSDT">Gala (GALA)</option>
            <option value="BINANCE:LDOUSDT">Lido DAO (LDO)</option>
            <option value="BINANCE:ROSEUSDT">Oasis Network (ROSE)</option>
            <option value="BINANCE:MINAUSDT">Mina (MINA)</option>
            <option value="BINANCE:API3USDT">API3 (API3)</option>
            <option value="BINANCE:JASMYUSDT">JasmyCoin (JASMY)</option>
            <option value="BINANCE:ICXUSDT">ICON (ICX)</option>
            <option value="BINANCE:BATUSDT">Basic Attention Token (BAT)</option>
            <option value="BINANCE:STORJUSDT">Storj (STORJ)</option>
            <option value="BINANCE:ANKRUSDT">Ankr (ANKR)</option>
            <option value="BINANCE:OCEANUSDT">Ocean Protocol (OCEAN)</option>
            <option value="BINANCE:ZILUSDT">Zilliqa (ZIL)</option>
            <option value="BINANCE:SKLUSDT">SKALE (SKL)</option>
            <option value="BINANCE:QTUMUSDT">Qtum (QTUM)</option>
            <option value="BINANCE:HOTUSDT">Holo (HOT)</option>
            <option value="BINANCE:ONTUSDT">Ontology (ONT)</option>
            <option value="BINANCE:RVNUSDT">Ravencoin (RVN)</option>
            <option value="BINANCE:GLMRUSDT">Moonbeam (GLMR)</option>
            <option value="BINANCE:IOTXUSDT">IoTeX (IOTX)</option>
            <option value="BINANCE:ONEUSDT">Harmony (ONE)</option>
            <option value="BINANCE:SCUSDT">Siacoin (SC)</option>
            <option value="BINANCE:CELRUSDT">Celer Network (CELR)</option>
            <option value="BINANCE:ACHUSDT">Alchemy Pay (ACH)</option>
            <option value="BINANCE:STMXUSDT">StormX (STMX)</option>
            <option value="BINANCE:ZENUSDT">Horizen (ZEN)</option>
            <option value="BINANCE:RSRUSDT">Reserve Rights (RSR)</option>
            <option value="BINANCE:YFIUSDT">yearn.finance (YFI)</option>
            <option value="BINANCE:BLURUSDT">Blur (BLUR)</option>
            <option value="BINANCE:PEOPLEUSDT">ConstitutionDAO (PEOPLE)</option>
            <option value="BINANCE:PERPUSDT">Perpetual Protocol (PERP)</option>
            <option value="BINANCE:UMAUSDT">UMA (UMA)</option>
            <option value="BINANCE:IDUSDT">SPACE ID (ID)</option>
            <option value="BINANCE:AGIXUSDT">SingularityNET (AGIX)</option>
            <option value="BINANCE:FETUSDT">Fetch.ai (FET)</option>
            <option value="BINANCE:LITUSDT">Litentry (LIT)</option>
            <option value="BINANCE:CTSIUSDT">Cartesi (CTSI)</option>
            <option value="BINANCE:ARUSDT">Arweave (AR)</option>
            <option value="BINANCE:DYDXUSDT">dYdX (DYDX)</option>
            <option value="BINANCE:OGNUSDT">Origin Protocol (OGN)</option>
            <option value="BINANCE:REEFUSDT">Reef Finance (REEF)</option>
            <option value="BINANCE:NMRUSDT">Numeraire (NMR)</option>
            <option value="BINANCE:MDTUSDT">Measurable Data Token (MDT)</option>
            <option value="BINANCE:KEYUSDT">SelfKey (KEY)</option>
            <option value="BINANCE:AUCTIONUSDT">Bounce Token (AUCTION)</option>
            <option value="BINANCE:ATAUSDT">Automata (ATA)</option>
            <option value="BINANCE:SLPUSDT">Smooth Love Potion (SLP)</option>
            <option value="BINANCE:ILVUSDT">Illuvium (ILV)</option>
            <option value="BINANCE:ALICEUSDT">MyNeighborAlice (ALICE)</option>
            <option value="BINANCE:SUPERUSDT">SuperVerse (SUPER)</option>
            <option value="BINANCE:MASKUSDT">Mask Network (MASK)</option>
            <option value="BINANCE:HIGHUSDT">Highstreet (HIGH)</option>
            <option value="BINANCE:INJUSDT">Injective (INJ)</option>
            <option value="BINANCE:RADUSDT">Radicle (RAD)</option>
            <option value="BINANCE:AMPUSDT">Amp (AMP)</option>
            <option value="BINANCE:TRBUSDT">Truebit (TRB)</option>
            <option value="BINANCE:ANTUSDT">Aragon (ANT)</option>
            <option value="BINANCE:CFXUSDT">Conflux (CFX)</option>
            <option value="BINANCE:SSVUSDT">SSV Network (SSV)</option>
            <option value="BINANCE:WOOUSDT">WOO Network (WOO)</option>
            <option value="BINANCE:BAKEUSDT">BakeryToken (BAKE)</option>
            <option value="BINANCE:GTCUSDT">Gitcoin (GTC)</option>
            <option value="BINANCE:FXSUSDT">Frax Share (FXS)</option>
            <option value="BINANCE:JOEUSDT">JOE (JOE)</option>
            <option value="BINANCE:RAYUSDT">Raydium (RAY)</option>
            <option value="BINANCE:QIUSDT">BENQI (QI)</option>
            <option value="BINANCE:SPELLUSDT">Spell Token (SPELL)</option>
            <option value="BINANCE:ALPHAUSDT">Alpha Finance (ALPHA)</option>
            <option value="BINANCE:REQUSDT">Request (REQ)</option>
            <option value="BINANCE:ORNUSDT">Orion Protocol (ORN)</option>
            <option value="BINANCE:TOMOUSDT">TomoChain (TOMO)</option>
            <option value="BINANCE:CTKUSDT">CertiK (CTK)</option>
            <option value="BINANCE:FORTHUSDT">Ampleforth Governance (FORTH)</option>
            <option value="BINANCE:FRONTUSDT">Frontier (FRONT)</option>
            <option value="BINANCE:TRUUSDT">TrueFi (TRU)</option>
            <option value="BINANCE:MBLUSDT">MovieBloc (MBL)</option>
            <option value="BINANCE:OXTUSDT">Orchid (OXT)</option>
            <option value="BINANCE:STPTUSDT">Standard Tokenization Protocol (STPT)</option>
            <option value="BINANCE:COCOSUSDT">COCOS BCX (COCOS)</option>
            <option value="BINANCE:TLMUSDT">Alien Worlds (TLM)</option>
            <option value="BINANCE:ERNUSDT">Ethernity Chain (ERN)</option>
            <option value="BINANCE:MLNUSDT">Enzyme (MLN)</option>
            <option value="BINANCE:UTKUSDT">Utrust (UTK)</option>
            <option value="BINANCE:VTHOUSDT">v.systems (VTHO)</option>
            <option value="BINANCE:WRXUSDT">WazirX (WRX)</option>
            <option value="BINANCE:DREPUSDT">Drep (DREP)</option>
            <option value="BINANCE:BEAMUSDT">Beam (BEAM)</option>
            <option value="BINANCE:AVAUSDT">Travala.com (AVA)</option>
            <option value="BINANCE:ARDRUSDT">Ardor (ARDR)</option>
            <option value="BINANCE:STMXUSDT">StormX (STMX)</option>
        </select>
        
        <label for="timeframe">Timeframe:</label>
        <select id="timeframe">
            <option value="1">1 Minute</option>
            <option value="5">5 Minutes</option>
            <option value="15" selected>15 Minutes</option>
            <option value="60">1 Hour</option>
        </select>
        
        <button onclick="deposit()">Deposit</button>
        <button onclick="withdraw()">Withdraw</button>
    </div>

    <div class="ad-banner middle-banner">
        <!-- Middle Content Banner (728x90) -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
             crossorigin="anonymous"></script>
        <!-- CryptoSim_Middle -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <div class="chart" id="tradingview-widget-container"></div>

    <div class="actions">
        <input type="number" placeholder="Amount (min $10)" id="trade-amount" min="10">
        <button id="buy-btn" onclick="buy()">Buy/Long</button>
        <button id="sell-btn" onclick="sell()">Sell/Short</button>
        <button onclick="cancelTrade()">Cancel</button>
        <button onclick="closeAll()">Close All</button>
        <button onclick="resetAccount()">Reset</button>
    </div>

    <div class="amazon-affiliate">
        <!-- Amazon Affiliate Button -->
        <a href="https://www.amazon.com/s?k=crypto+hardware+wallet&tag=yourtag-20" class="amazon-btn" target="_blank">
            <span>Shop Crypto Products on Amazon</span>
        </a>
    </div>

    <h2 style="text-align: center;">Trade on Top Cryptos Exchanges</h2>
    <div class="exchange-grid">
        <!-- Ordered as requested -->
        <div class="exchange-card">
            <img src="logo/binance.png" class="exchange-logo">
            <div class="exchange-name">Binance</div>
            <div class="exchange-fiat">USD, EUR, GBP, BRL +8 more</div>
            <a href="https://accounts.binance.com/register?ref=13150265" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/bybit.png" class="exchange-logo">
            <div class="exchange-name">Bybit</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +5 more</div>
            <a href="https://www.bybit.com/invite?ref=6GN055J" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>            
        </div>
        <div class="exchange-card">
            <img src="logo/bitso.png" class="exchange-logo">
            <div class="exchange-name">Bitso</div>
            <div class="exchange-fiat">MXN, ARS, BRL, USD</div>
            <a href="https://bitso.com/?ref=uyca" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/coinbase.png" class="exchange-logo">
            <div class="exchange-name">Coinbase</div>
            <div class="exchange-fiat">USD, EUR, GBP, CAD +7 more</div>
            <div class="exchange-signup">Sign Up</div>
        </div>        
        <div class="exchange-card">
            <img src="logo/okx.png" class="exchange-logo">
            <div class="exchange-name">OKX</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +6 more</div>
            <a href="https://okx.com/join/37153892" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/bitget.png" class="exchange-logo">
            <div class="exchange-name">Bitget</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +4 more</div>
            <a href="https://share.bitget.com/u/9U7F1J5T" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/mexc.png"  class="exchange-logo">
            <div class="exchange-name">MEXC</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +5 more</div>
            <a href="https://promote.mexc.com/r/3SSKENHs" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/gate.png" class="exchange-logo">
            <div class="exchange-name">Gate.io</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +7 more</div>
            <a href="/" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/Htx.png" class="exchange-logo">
            <div class="exchange-name">HTX</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +6 more</div>
            <a href="https://www.htx.com/invite/es-la/1f?invite_code=k73kc223" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/kucoin.png" class="exchange-logo">
            <div class="exchange-name">KuCoin</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +5 more</div>
            <a href="https://www.kucoin.com/r/rf/CX8TUK3Z" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/bitfinex.png" class="exchange-logo">
            <div class="exchange-name">Bitfinex</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY</div>
            <div class="exchange-signup">Sign Up</div>
        </div>
        <div class="exchange-card">
            <img src="logo/bingX.png" class="exchange-logo">
            <div class="exchange-name">BingX</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +4 more</div>
            <a href="https://bingx.com/invite/BSIQF4" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>        
        <div class="exchange-card">
            <img src="logo/bitmart.png" class="exchange-logo">
            <div class="exchange-name">BitMart</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +3 more</div>
            <a href="https://www.bitmart.com/invite/nDFXdE/es" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/Lbank.png" class="exchange-logo">
            <div class="exchange-name">LBank</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +4 more</div>
            <a href="https://lbank.com/ref/EPKJ" target="_blank" style="color:#ffffff; font-weight:roman;">Sign Up</a>
        </div>
        <div class="exchange-card">
            <img src="logo/xt.png" alt="XT.COM" class="exchange-logo">
            <div class="exchange-name">XT.COM</div>
            <div class="exchange-fiat">USD, EUR, GBP, JPY +5 more</div>
            <div class="exchange-signup">Sign Up</div>
        </div>
    </div>
   <!-- ======= LIVE CRYPTO NEWS SECTION ======= -->
<section class="crypto-news-section" id="crypto-news">
    <div class="news-header">
        <h2>ðŸ“¡ Live Crypto News Dashboard</h2>
        <p class="subtitle">Stay updated with the latest crypto market news and trends in real time</p>
        <div class="news-controls">
            <div class="button-row">
                <button id="toggle-news" class="news-btn collapse-btn">
                    <i class="fas fa-compress-alt"></i> Collapse
                </button>
                <button id="refresh-news" class="news-btn refresh-btn">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <div class="search-container">
                    <input type="text" id="crypto-search" placeholder="Search crypto news..." class="search-input">
                    <button id="search-btn" class="news-btn search-btn">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
            </div>
            <div class="button-row filter-buttons">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="bitcoin">Bitcoin</button>
                <button class="filter-btn" data-filter="ethereum">Ethereum</button>
                <button class="filter-btn" data-filter="altcoins">Altcoins</button>
                <button class="filter-btn" data-filter="memecoins">Memecoins</button>
                <button class="filter-btn" data-filter="nft">NFT</button>
                <button class="filter-btn" data-filter="defi">DeFi</button>
                <button class="filter-btn" data-filter="games">Crypto Games</button>
                <button class="filter-btn" data-filter="trending">Trending</button>
                <button class="filter-btn" data-filter="security">Security</button>
                <button class="filter-btn" data-filter="mining">Mining</button>
                <button class="filter-btn" data-filter="regulation">Regulation</button>
            </div>
        </div>
    </div>

    <div class="news-container">
        <div class="news-grid" id="news-grid">
            <div class="news-loading">
                <div class="loading-spinner"></div>
                <p>Loading crypto news...</p>
            </div>
        </div>
    </div>

    <!-- Market Stats Widget -->
    <div class="market-stats-widget" id="market-stats">
        <h3><i class="fas fa-chart-pie"></i> Global Crypto Market Stats</h3>
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="market-cap">$2.34T <span class="positive"><i class="fas fa-caret-up"></i> 1.2%</span></div>
                <div class="stat-label">Market Cap</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="volume">$84.5B <span class="positive"><i class="fas fa-caret-up"></i> 3.4%</span></div>
                <div class="stat-label">24h Volume</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="btc-dominance">51.3% <span class="negative"><i class="fas fa-caret-down"></i> 0.7%</span></div>
                <div class="stat-label">BTC Dominance</div>
            </div>
            <div class="stat-card">
                <div class="stat-value"><i class="fas fa-smile"></i> 72/100</div>
                <div class="stat-label">Market Sentiment</div>
            </div>
        </div>
    </div>

    <!-- News Modal -->
    <div class="news-modal" id="news-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modal-title"></h2>
            <div class="modal-meta">
                <span id="modal-source"></span>
                <span id="modal-date"></span>
            </div>
            <div id="modal-image-container"></div>
            <div id="modal-content"></div>
        </div>
    </div>
</section>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<!-- Google Fonts - Inter -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
    /* General body styles from tradescript.html and Inter font */
    body {
        font-family: 'Inter', sans-serif;
        background: #0e1116; /* Black background from tradescript.html */
        color: #e2e8f0;
        line-height: 1.6;
        padding: 20px;
    }

    /* Styles for the News Section */
    .crypto-news-section {
        background: #1e222d; /* Darker gray background for the section */
        border-radius: 16px;
        padding: 20px; /* Reduced padding for compactness */
        margin: 30px auto;
        border: 1px solid #334155;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        max-width: 1200px; /* Max width for compactness */
    }

    .news-header {
        text-align: center;
        margin-bottom: 20px; /* Reduced margin */
    }

    .news-header h2 {
        font-size: 2rem; /* Slightly smaller font for compactness */
        margin-bottom: 8px;
        color: #e2e8f0;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    .subtitle {
        color: #94a3b8;
        font-size: 1.1rem; /* Slightly smaller font */
        max-width: 600px;
        margin: 0 auto 15px auto; /* Reduced margin */
    }

    .news-controls {
        display: flex;
        flex-direction: column;
        gap: 10px; /* Reduced gap */
        margin-bottom: 15px; /* Reduced margin */
    }

    .button-row {
        display: flex;
        flex-wrap: wrap;
        gap: 8px; /* Reduced gap */
        align-items: center;
        justify-content: center;
    }

    .news-btn, .filter-btn {
        padding: 8px 15px; /* Reduced padding for compactness */
        border-radius: 6px; /* Slightly smaller radius */
        font-size: 14px; /* Slightly smaller font */
    }

    .news-btn {
        background: #3a8dd8; /* Use blue from tradescript.html */
        color: #fff;
        border: none;
        cursor: pointer;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 6px;
        font-weight: 600;
        box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
    }

    .news-btn:hover {
        background: #337ac4; /* Darker blue on hover */
        transform: translateY(-2px);
        box-shadow: 0 5px 8px rgba(0, 0, 0, 0.15);
    }

    .collapse-btn {
        background: #10b981; /* Green color */
    }
    .collapse-btn:hover {
        background: #059669;
    }

    .refresh-btn {
        background: #3a8dd8;
    }

    .search-btn {
        background: #64748b;
    }
    .search-btn:hover {
        background: #475569;
    }

    .filter-btn {
        background: #1e222d; /* Background color of tradescript.html header */
        color: #cbd5e1;
        border: 1px solid #334155; /* Slight border for definition */
        font-weight: 500;
    }

    .filter-btn.active {
        background: #3a8dd8; /* Use blue from tradescript.html */
        color: white;
        box-shadow: 0 0 0 2px rgba(58, 141, 216, 0.4);
    }

    .filter-btn:hover:not(.active) {
        background: #2c313a; /* Darker grey on hover */
    }

    .search-container {
        display: flex;
        align-items: center;
        margin-left: auto;
        background: #2c313a; /* Darker grey from tradescript.html th */
        border-radius: 6px;
        overflow: hidden;
        border: 1px solid #334155;
        transition: all 0.2s;
    }

    .search-container:focus-within {
        border-color: #3a8dd8;
        box-shadow: 0 0 0 2px rgba(58, 141, 216, 0.4);
    }

    .search-input {
        padding: 8px 12px;
        border: none;
        background: transparent;
        color: #e2e8f0;
        font-size: 14px;
        width: 200px; /* Slightly narrower */
        outline: none;
    }

    .search-input::placeholder {
        color: #94a3b8;
    }

    .news-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); /* Adjusted minmax for compactness */
        gap: 20px; /* Reduced gap for compactness */
        margin-top: 20px;
    }

    .news-card {
        background: #1e222d; /* Matches section background */
        border-radius: 10px; /* Slightly smaller radius */
        padding: 15px; /* Consistent padding */
        transition: transform 0.3s, box-shadow 0.3s;
        border: 1px solid #2c313a; /* Darker border */
        cursor: pointer;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
    }

    .news-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        border-color: #3a8dd8;
    }

    .news-image-container {
        width: 100%;
        height: 160px; /* Height of image container slightly reduced for compactness */
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 10px;
        position: relative;
    }

    .news-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s;
    }

    .news-card:hover .news-image {
        transform: scale(1.05);
    }

    .default-image {
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg, #2c313a, #1e222d);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #94a3b8;
        font-size: 13px;
        text-align: center;
        padding: 10px;
    }

    .news-card h3 {
        color: #e2e8f0;
        font-size: 17px; /* Slightly smaller font */
        margin: 0 0 5px 0; /* Reduced margin for compactness */
        line-height: 1.3;
        font-weight: 600;
        flex-grow: 1;
    }

    .news-content {
        color: #94a3b8;
        font-size: 14px; /* Slightly smaller font */
        margin-bottom: 8px; /* Reduced margin for compactness */
        line-height: 1.5;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .news-meta {
        color: #7b8a9c;
        font-size: 11px; /* Smaller font */
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: auto;
    }

    .source-badge {
        background: #2c313a; /* Matches table header/search container */
        padding: 2px 5px;
        border-radius: 3px;
        font-size: 10px;
    }

    /* Market Stats Widget Styles (adjusted for consistency) */
    .market-stats-widget {
        background: #1e222d; /* Matches section background */
        border-radius: 16px;
        padding: 20px;
        margin-top: 30px;
        border: 1px solid #334155;
    }

    .market-stats-widget h3 {
        color: #e2e8f0;
        margin-top: 0;
        margin-bottom: 15px; /* Reduced margin */
        font-size: 17px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); /* Adjusted minmax */
        gap: 15px; /* Reduced gap */
    }

    .stat-card {
        background: #2c313a; /* Darker gray */
        border-radius: 8px; /* Slightly smaller radius */
        padding: 15px; /* Reduced padding */
        text-align: center;
        transition: transform 0.3s;
        border: 1px solid #334155;
    }

    .stat-card:hover {
        transform: translateY(-2px);
        border-color: #3a8dd8;
    }

    .stat-value {
        color: #e2e8f0;
        font-size: 22px; /* Slightly smaller */
        font-weight: 700;
        margin-bottom: 6px; /* Reduced margin */
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
    }

    .positive {
        color: #00ff9f; /* Green from tradescript.html */
    }

    .negative {
        color: #ff4d4d; /* Red from tradescript.html */
    }

    .stat-label {
        color: #94a3b8;
        font-size: 13px; /* Slightly smaller */
    }

    /* News Modal Styles (adjusted for consistency) */
    .news-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.9);
        overflow-y: auto;
        backdrop-filter: blur(5px);
    }

    .modal-content {
        background-color: #1e222d; /* Matches section background */
        margin: 30px auto; /* Adjusted margin */
        padding: 25px; /* Reduced padding */
        border: 1px solid #334155;
        border-radius: 12px;
        width: 95%;
        max-width: 800px; /* Reduced max-width for compactness */
        position: relative;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
    }

    .close-modal {
        color: #94a3b8;
        position: absolute;
        right: 20px; /* Adjusted position */
        top: 20px; /* Adjusted position */
        font-size: 30px;
        font-weight: bold;
        cursor: pointer;
        transition: color 0.3s;
        z-index: 10;
    }

    .close-modal:hover {
        color: #e2e8f0;
    }

    #modal-title {
        color: #e2e8f0;
        margin-top: 0;
        margin-bottom: 15px; /* Reduced margin */
        font-size: 26px; /* Slightly smaller */
        line-height: 1.3;
        padding-right: 20px;
    }

    .modal-meta {
        color: #94a3b8;
        font-size: 15px; /* Slightly smaller */
        margin-bottom: 20px; /* Reduced margin */
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 10px; /* Reduced gap */
        padding-bottom: 10px; /* Reduced padding */
        border-bottom: 1px solid #334155;
    }

    #modal-image-container {
        margin-bottom: 20px; /* Reduced margin */
        border-radius: 8px; /* Slightly smaller radius */
        overflow: hidden;
        max-height: 400px; /* Reduced max height */
    }

    #modal-image-container img {
        width: 100%;
        height: auto;
        display: block;
    }

    #modal-content {
        color: #cbd5e1;
        line-height: 1.7; /* Slightly tighter line height */
        font-size: 16px; /* Slightly smaller font */
    }

    #modal-content p {
        margin-bottom: 15px; /* Reduced margin */
    }

    /* Hidden keywords for SEO */
    .article-keywords {
        position: absolute;
        width: 1px;
        height: 1px;
        margin: -1px;
        padding: 0;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        border: 0;
    }

    .news-loading, .news-error, .news-empty {
        color: #94a3b8;
        text-align: center;
        padding: 30px 15px; /* Reduced padding */
        grid-column: 1 / -1;
        font-size: 16px; /* Slightly smaller */
    }

    .loading-spinner {
        border: 3px solid rgba(58, 141, 216, 0.3); /* Smaller border */
        border-top: 3px solid #3a8dd8;
        width: 40px; /* Smaller size */
        height: 40px;
        margin: 0 auto 15px; /* Reduced margin */
    }

    .notification {
        padding: 12px 20px; /* Reduced padding */
        border-radius: 6px; /* Smaller radius */
        font-size: 14px; /* Smaller font */
    }

    /* Media Queries for Responsiveness */
    @media (max-width: 768px) {
        .crypto-news-section {
            padding: 15px;
            margin: 20px auto;
        }
        .news-header h2 {
            font-size: 1.8rem;
        }
        .subtitle {
            font-size: 1rem;
        }
        .news-btn, .filter-btn {
            padding: 7px 12px;
            font-size: 13px;
        }
        .search-input {
            width: 100%;
        }
        .news-grid {
            grid-template-columns: 1fr;
            gap: 15px;
        }
        .news-card {
            padding: 10px;
        }
        .news-card h3 {
            font-size: 16px;
        }
        .news-content {
            font-size: 13px;
        }
        .news-meta {
            font-size: 10px;
        }
        .modal-content {
            margin: 20px auto;
            padding: 20px;
        }
        #modal-title {
            font-size: 22px;
        }
        .modal-meta {
            font-size: 14px;
        }
        #modal-image-container {
            max-height: 250px;
        }
        #modal-content {
            font-size: 15px;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', async () => {
        // Configuration
        const RSS_PROXY = "https://api.rss2json.com/v1/api.json?rss_url=";
        const RSS_FEEDS = [
            "https://cointelegraph.com/rss",
            "https://decrypt.co/feed",
            "https://cryptonews.com/news/feed/",
            "https://www.coindesk.com/arc/outboundfeeds/rss/"
        ].map(url => RSS_PROXY + encodeURIComponent(url));

        const COINGECKO_API = "https://api.coingecko.com/api/v3/global";

        // DOM Elements
        const newsGrid = document.getElementById('news-grid');
        const toggleBtn = document.getElementById('toggle-news');
        const refreshBtn = document.getElementById('refresh-news');
        const filterBtns = document.querySelectorAll('.filter-btn');
        const searchInput = document.getElementById('crypto-search');
        const searchBtn = document.getElementById('search-btn');
        const modal = document.getElementById('news-modal');
        const closeModal = document.querySelector('.close-modal');
        
        // State
        let allNews = [];
        let currentFilter = 'all';
        let isExpanded = true;

        // Initialization
        loadNews();
        loadMarketStats();
        setupEventListeners();

        // ===== MAIN FUNCTIONS =====
        async function loadNews() {
            try {
                newsGrid.innerHTML = `
                    <div class="news-loading">
                        <div class="loading-spinner"></div>
                        <p>Loading crypto news...</p>
                    </div>
                `;
                
                const news = await fetchNews(RSS_FEEDS);
                allNews = news;
                
                renderNews(filterNews(allNews, currentFilter));
            } catch (error) {
                console.error("Error loading news:", error);
                newsGrid.innerHTML = '<div class="news-error">Failed to load news. Try refreshing.</div>';
            }
        }

        async function fetchNews(feeds) {
            try {
                const responses = await Promise.all(
                    feeds.map(url => fetch(url).then(res => res.json()))
                );
                
                // Extract news and process images
                const newsItems = responses.flatMap(res => 
                    res.items?.map(item => {
                        const imageUrl = extractFirstImage(item.description) || 
                                        (item.enclosure && item.enclosure.link) || 
                                        (item.thumbnail && item.thumbnail) || 
                                        null;
                        
                        return {
                            title: item.title,
                            content: item.description || "No content available",
                            source: res.feed?.title.replace(/ - Latest News|Feed/g, "") || "Unknown Source",
                            date: item.pubDate || new Date().toISOString(),
                            keywords: extractKeywords(item.title + " " + (item.description || "")),
                            image: imageUrl,
                            // Clean and sanitize the content for the modal
                            fullContent: cleanAndSanitizeContent(item.description || item.content || ""), 
                            link: item.link
                        };
                    }) || []
                );
                
                return newsItems;
            } catch (error) {
                console.error("Error fetching news:", error);
                return [];
            }
        }

        function renderNews(news) {
            if (!news.length) {
                newsGrid.innerHTML = '<div class="news-empty">No news available for this filter.</div>';
                return;
            }

            newsGrid.innerHTML = news.map(item => `
                <div class="news-card" data-keywords="${item.keywords.join(',')}" aria-label="${item.title}">
                    <div class="news-image-container">
                        ${item.image ? 
                            `<img src="${item.image}" alt="${item.title}" class="news-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/334155/e2e8f0?text=Image+Not+Available';">` : 
                            `<div class="default-image" role="img" aria-label="Image not available for ${item.title}"><i class="fas fa-newspaper"></i> Image not available</div>`
                        }
                    </div>
                    <h3>${item.title}</h3>
                    <div class="news-content">${truncateContent(item.content, 150)}</div>
                    <div class="news-meta">
                        <span class="source-badge">${item.source}</span>
                        <span>${formatDate(item.date)}</span>
                    </div>
                </div>
            `).join('');

            // Add event listeners to news cards
            document.querySelectorAll('.news-card').forEach((card, index) => {
                card.addEventListener('click', () => openNewsModal(news[index]));
            });
        }

        async function loadMarketStats() {
            try {
                // Using real data from CoinGecko API
                const response = await fetch(COINGECKO_API);
                const data = await response.json();
                
                document.getElementById('market-cap').innerHTML = `$${formatNumber(data.data.total_market_cap.usd)} <span class="positive"><i class="fas fa-caret-up"></i> ${(data.data.market_cap_change_percentage_24h_usd || 1.2).toFixed(1)}%</span>`;
                document.getElementById('volume').innerHTML = `$${formatNumber(data.data.total_volume.usd)} <span class="positive"><i class="fas fa-caret-up"></i> 3.4%</span>`;
                document.getElementById('btc-dominance').innerHTML = `${data.data.market_cap_percentage.btc.toFixed(1)}% <span class="negative"><i class="fas fa-caret-down"></i> 0.7%</span>`;
            } catch (error) {
                console.error("Error loading market stats:", error);
                // Keep the sample data already in the HTML. It's safe for free APIs to fail.
            }
        }

        function openNewsModal(newsItem) {
            if (newsItem) {
                document.getElementById('modal-title').textContent = newsItem.title;
                document.getElementById('modal-source').textContent = newsItem.source;
                document.getElementById('modal-date').textContent = formatDate(newsItem.date, true);
                
                const imageContainer = document.getElementById('modal-image-container');
                imageContainer.innerHTML = newsItem.image ? 
                    `<img src="${newsItem.image}" alt="${newsItem.title}" class="news-image" onerror="this.onerror=null;this.src='https://placehold.co/600x400/334155/e2e8f0?text=Image+Not+Available+in+Modal';">` : 
                    `<div class="default-image" style="height: 200px;" role="img" aria-label="Image not available for ${newsItem.title}"><i class="fas fa-newspaper fa-3x"></i><p>Image not available</p></div>`;
                
                // Ensure the clean HTML content is inserted directly
                // Keywords are now in a visually hidden div for SEO purposes
                document.getElementById('modal-content').innerHTML = `
                    <div id="article-content">
                        ${newsItem.fullContent || '<p>Content not available.</p>'}
                    </div>
                    ${newsItem.keywords.length > 0 ? `
                        <div class="article-keywords" aria-hidden="true">
                            <h4>Keywords:</h4>
                            <div>
                                ${newsItem.keywords.map(keyword => `<span>#${keyword}</span>`).join('')}
                            </div>
                        </div>
                    ` : ''}
                `;
                
                modal.style.display = "block";
                document.body.style.overflow = "hidden"; // Disable body scroll
            }
        }

        function closeNewsModal() {
            modal.style.display = "none";
            document.body.style.overflow = "auto"; // Enable body scroll
        }

        // ===== BUTTON AND FILTER FUNCTIONALITY =====
        function setupEventListeners() {
            // Collapse/Expand Button
            toggleBtn.addEventListener('click', () => {
                isExpanded = !isExpanded;
                const newsContainer = document.querySelector('.news-container');
                newsContainer.style.display = isExpanded ? 'block' : 'none';
                toggleBtn.innerHTML = isExpanded ? 
                    '<i class="fas fa-compress-alt"></i> Collapse' : 
                    '<i class="fas fa-expand-alt"></i> Expand';
            });

            // Refresh Button
            refreshBtn.addEventListener('click', () => {
                // Spin animation
                refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
                
                // Reload news
                loadNews();
                loadMarketStats();
                
                // Restore button after 2 seconds and show notification
                setTimeout(() => {
                    refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Refresh';
                    showNotification('News updated successfully');
                }, 2000);
            });

            // Filter Buttons
            filterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    filterBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    renderNews(filterNews(allNews, currentFilter));
                });
            });

            // Search
            searchBtn.addEventListener('click', () => {
                const searchTerm = searchInput.value.trim().toLowerCase();
                if (searchTerm) {
                    const filtered = allNews.filter(item => 
                        item.title.toLowerCase().includes(searchTerm) || 
                        item.content.toLowerCase().includes(searchTerm) ||
                        item.keywords.some(kw => kw.includes(searchTerm))
                    );
                    renderNews(filtered);
                } else {
                    renderNews(filterNews(allNews, currentFilter));
                }
            });

            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchBtn.click();
                }
            });

            // Modal
            closeModal.addEventListener('click', closeNewsModal);
            window.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeNewsModal();
                }
            });
        }

        function filterNews(news, filter) {
            if (filter === 'all') return news;
            
            const filterMap = {
                bitcoin: ['bitcoin', 'btc'],
                ethereum: ['ethereum', 'eth'],
                altcoins: ['altcoin', 'xrp', 'solana', 'cardano', 'polkadot', 'avalanche', 'litecoin'],
                memecoins: ['meme', 'dogecoin', 'shiba', 'pepe', 'doge', 'shib'],
                nft: ['nft', 'non-fungible', 'non fungible', 'digital art', 'collectible'],
                defi: ['defi', 'decentralized finance', 'staking', 'yield', 'lending', 'borrowing'],
                games: ['game', 'nft', 'metaverse', 'web3', 'play-to-earn', 'gaming'],
                trending: ['trending', 'bullish', 'bearish', 'rally', 'surge', 'price prediction'],
                security: ['security', 'hack', 'phishing', 'scam', 'audit'],
                mining: ['mining', 'miner', 'hashrate', 'proof-of-work', 'pow', 'gpu'],
                regulation: ['regulation', 'sec', 'cftc', 'policy', 'law', 'government']
            };
            
            const keywords = filterMap[filter] || [filter];
            return news.filter(item => 
                keywords.some(kw => 
                    item.title.toLowerCase().includes(kw) || 
                    item.keywords.includes(kw)
                )
            );
        }

        // ===== HELPER FUNCTIONS =====
        function extractKeywords(text) {
            const keywords = [
                'bitcoin', 'ethereum', 'btc', 'eth', 
                'bullish', 'bearish', 'altcoin', 'meme',
                'game', 'nft', 'defi', 'web3', 'trending',
                'solana', 'cardano', 'polkadot', 'xrp',
                'dogecoin', 'shiba', 'pepe', 'avalanche',
                'blockchain', 'crypto', 'token', 'coin',
                'exchange', 'wallet', 'mining', 'staking',
                'security', 'hack', 'phishing', 'scam', 'audit',
                'miner', 'hashrate', 'proof-of-work', 'pow', 'gpu',
                'regulation', 'sec', 'cftc', 'policy', 'law', 'government'
            ];
            // Filter keywords from the text to ensure relevance
            const extracted = keywords.filter(kw => text.toLowerCase().includes(kw));
            // Add some generic keywords if none are found, or if too few
            if (extracted.length < 3) {
                if (text.toLowerCase().includes('crypto')) extracted.push('crypto');
                if (text.toLowerCase().includes('market')) extracted.push('market');
                if (text.toLowerCase().includes('news')) extracted.push('news');
            }
            // Remove duplicates and limit to a reasonable number
            return [...new Set(extracted)].slice(0, 5);
        }

        function extractFirstImage(html) {
            if (!html) return null;
            const imgRegex = /<img[^>]+src="([^">]+)"/;
            const match = html.match(imgRegex);
            return match ? match[1] : null;
        }

        // Function to clean and sanitize HTML content for display in modal
        function cleanAndSanitizeContent(html) {
            if (!html) return '';
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            tempDiv.querySelectorAll('script').forEach(script => script.remove());
            tempDiv.querySelectorAll('a').forEach(link => {
                const span = document.createElement('span');
                span.textContent = link.textContent;
                link.replaceWith(span);
            });
            tempDiv.querySelectorAll('img').forEach(img => img.remove());
            tempDiv.querySelectorAll('iframe').forEach(iframe => iframe.remove());
            tempDiv.querySelectorAll('[style]').forEach(el => el.removeAttribute('style'));
            tempDiv.querySelectorAll('[class]').forEach(el => el.removeAttribute('class'));
            return tempDiv.innerHTML;
        }

        function formatDate(dateStr, full = false) {
            const date = new Date(dateStr);
            if (full) {
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
            return date.toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric'
            });
        }

        function truncateContent(text, maxLength) {
            if (!text) return '';
            const stripped = text.replace(/<[^>]*>/g, '');
            return stripped.length > maxLength ? 
                stripped.substring(0, maxLength) + '...' : 
                stripped;
        }

        function formatNumber(num) {
            return new Intl.NumberFormat('en-US', {
                notation: 'compact',
                maximumFractionDigits: 1
            }).format(num);
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Sample data for demonstration
        setTimeout(() => {
            if (document.querySelector('.news-loading')) {
                const sampleNews = [
                    {
                        title: "Bitcoin ETFs See Record Inflows, Boosting Market Confidence",
                        content: "Spot Bitcoin Exchange-Traded Funds (ETFs) have experienced unprecedented inflows this week, signaling growing institutional interest and confidence in the cryptocurrency market. This surge in investment is widely seen as a bullish indicator for Bitcoin's price trajectory.",
                        source: "Cointelegraph",
                        date: new Date().toISOString(),
                        image: "https://images.cointelegraph.com/images/840_aHR0cHM6Ly9zMy5jb2ludGVsZWdyYXBoLmNvbS91cGxvYWRzLzIwMjQtMDYvYjYxY2NkZjMtZWM1OS00ZDc0LWI4M2MtY2Q4YjM0Y2FhYjI4LmpwZw==.jpg",
                        fullContent: `
                            <p>Spot Bitcoin Exchange-Traded Funds (ETFs) have experienced unprecedented inflows this week, signaling growing institutional interest and confidence in the cryptocurrency market. This surge in investment is widely seen as a bullish indicator for Bitcoin's price trajectory.</p>
                            <p>Analysts report that the cumulative net inflows into these ETFs have surpassed $1.5 billion in the past five trading days, a new record since their inception. Major financial institutions are increasingly allocating capital into these investment vehicles, providing traditional investors with regulated access to Bitcoin.</p>
                            <p>The increased demand comes amidst a period of relative stability in the broader financial markets, making Bitcoin an attractive asset for diversification. Experts suggest that the continued acceptance of Bitcoin ETFs by mainstream finance could pave the way for further cryptocurrency derivatives and investment products.</p>
                            <p>Despite some volatility, the underlying sentiment remains strong, driven by macroeconomic factors and the upcoming Bitcoin halving event, which historically has preceded significant price rallies. The market eagerly anticipates how these new capital injections will influence Bitcoin's position as a global asset.</p>
                        `,
                        link: "#" 
                    },
                    {
                        title: "Ethereum's Dencun Upgrade Sets Stage for Layer-2 Dominance",
                        content: "The successful implementation of Ethereum's Dencun upgrade marks a pivotal moment for Layer-2 scaling solutions, promising reduced transaction costs and enhanced network efficiency.",
                        source: "Decrypt",
                        date: new Date(Date.now() - 86400000).toISOString(),
                        image: "https://decrypt.co/wp-content/uploads/2023/04/ETH_merge_shutterstock_1926591354.jpg?w=1024",
                        fullContent: `
                            <p>The successful implementation of Ethereum's Dencun upgrade marks a pivotal moment for Layer-2 scaling solutions, promising reduced transaction costs and enhanced network efficiency. This upgrade introduces "proto-danksharding," which significantly lowers data availability costs for rollups.</p>
                            <p>Rollups, such as Arbitrum and Optimism, are expected to benefit most from this upgrade, as they can now post transaction data more cheaply to the Ethereum mainnet. This reduction in cost is anticipated to be passed on to end-users, making decentralized applications (dApps) more accessible and affordable.</p>
                            <p>The Dencun upgrade is a crucial step in Ethereum's roadmap towards scalability, moving closer to a future where the network can handle mass adoption without prohibitive gas fees. Developers are already leveraging the new capabilities to build more complex and efficient applications.</p>
                            <p>Community response has been largely positive, with many seeing this as a necessary evolution for Ethereum to maintain its lead in the smart contract platform space. The upgrade is expected to foster innovation and growth across the DeFi and NFT ecosystems built on Ethereum Layer-2s.</p>
                        `,
                        link: "#"
                    },
                    {
                        title: "Gaming Guilds Redefine Play-to-Earn Economy with Massive Growth",
                        content: "Gaming guilds are rapidly expanding, transforming the play-to-earn (P2E) landscape by providing scholarships and capital to new players in blockchain games.",
                        source: "CryptoNews",
                        date: new Date(Date.now() - 172800000).toISOString(),
                        image: "https://cryptonews.com/wp-content/uploads/2023/05/nft-art.jpg",
                        fullContent: `
                            <p>Gaming guilds are rapidly expanding, transforming the play-to-earn (P2E) landscape by providing scholarships and capital to new players in blockchain games. These decentralized autonomous organizations (DAOs) pool resources to acquire valuable in-game assets and then lend them to players who might not otherwise afford them.</p>
                            <p>This model creates a symbiotic relationship where guilds earn a share of the players' in-game earnings, while players gain access to opportunities without upfront investment. This democratizes access to P2E games, especially in emerging markets where gaming can be a significant source of income.</p>
                            <p>The growth of these guilds highlights the evolving nature of the gaming industry, moving towards more community-driven and economically empowering models. Experts believe that gaming guilds will play a crucial role in onboarding the next wave of users into the broader Web3 ecosystem.</p>
                            <p>Challenges remain, including managing large and diverse player bases, optimizing asset utilization, and adapting to fluctuating game economies. However, continuous innovation in guild management tools and incentive structures promises to overcome these hurdles, fostering sustainable growth.</p>
                        `,
                        link: "#"
                    },
                    {
                        title: "DeFi Protocols Innovate with Real-World Asset Tokenization",
                        content: "Decentralized Finance (DeFi) is bridging the gap with traditional finance by increasingly tokenizing real-world assets (RWAs), from real estate to commodities.",
                        source: "CoinDesk",
                        date: new Date(Date.now() - 259200000).toISOString(),
                        image: "https://www.coindesk.com/resizer/v2/3JX5GQKXWZD5HLO7D6GZ5X2WHE.jpg",
                        fullContent: `
                            <p>Decentralized Finance (DeFi) is bridging the gap with traditional finance by increasingly tokenizing real-world assets (RWAs), from real estate to commodities. This innovation allows tangible assets to be represented as digital tokens on a blockchain, enabling fractional ownership, increased liquidity, and broader access to investments.</p>
                            <p>By tokenizing RWAs, DeFi protocols are opening up new avenues for capital efficiency and financial inclusion. Investors can gain exposure to assets like property, art, or even debt instruments without traditional intermediaries, often with lower transaction costs and faster settlement times.</p>
                            <p>This trend signifies a maturation of the DeFi space, moving beyond purely crypto-native assets to integrate with the multi-trillion dollar traditional financial markets. Regulatory frameworks are slowly adapting to accommodate these new financial instruments, paving the way for wider adoption.</p>
                            <p>Challenges include legal enforceability of tokenized ownership, accurate valuation of physical assets, and ensuring compliance across different jurisdictions. Nevertheless, the potential benefits in terms of transparency, accessibility, and efficiency are driving significant interest and development in the RWA tokenization sector.</p>
                        `,
                        link: "#"
                    }
                ];
                
                renderNews(sampleNews);
                allNews = sampleNews;
            }
        }, 1500); // Small delay to simulate loading
    });
</script>  
            
    <div class="ad-banner bottom-banner">
        <!-- Bottom Content Banner (728x90) -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
             crossorigin="anonymous"></script>
        <!-- CryptoSim_Bottom -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>

    <!-- Trading History Table -->
        <h2>Trading History</h2>
        <table style="width: 100 %; border-collapse: collapse;">
        <thead>
            <tr>
                <th>#</th>
                <th>Coin</th>
                <th>Amount</th>
                <th>Result</th>
                <th>Status</th>
                <th>Time</th>
            </tr>
        </thead>
        <tbody id="history-table">
            <!-- History rows will be added here -->
        </tbody>
    </table>
</div>

<footer>
    <div class="footer-links">
        <a href="footer/about.html">About</a>
        <a href="footer/howtoplay.html">How to Play</a>
        <a href="footer/faq.html">FAQ</a>
        <a href="footer/privacypolicy.html">Privacy Policy</a>
        <a href="footer/terms.html">Terms of Service</a>
        <a href="footer/contact.html">Contact</a>
    </div>
    <p>&copy; 2025 TradeSim. All rights reserved.</p>
</footer>

<script src="https://s3.tradingview.com/tv.js"></script>
<script>
    'use strict';
    
    // Trading Simulation Logic
    let selectedSymbol = document.getElementById("crypto-select").value;
    let chartWidget;
    let balance = 100000;
    let currentStake = 0;
    let tradeRunning = false;
    let profitOrLoss = 0;
    let tradeId = 1;
    let timerInterval = null;
    let secondsLeft = 0;

    const balanceDisplay = document.getElementById("balance");
    const profitLossDisplay = document.getElementById("profit-loss");
    const timerDisplay = document.getElementById("timer");

    function updateBalance() {
        balanceDisplay.textContent = balance.toFixed(2);
    }

    function showProfitLoss(text, isProfit = true) {
        profitLossDisplay.textContent = text;
        profitLossDisplay.className = isProfit ? "profit-loss profit" : "profit-loss loss";
    }

    function addHistory(status) {
        const table = document.getElementById("history-table");
        const row = table.insertRow(0);
        row.innerHTML = `
            <td>${tradeId++}</td>
            <td>${selectedSymbol.split(":")[1]}</td>
            <td>$${currentStake.toFixed(2)}</td>
            <td>${profitOrLoss >= 0 ? '+' : '-'}$${Math.abs(profitOrLoss).toFixed(2)}</td>
            <td>${status}</td>
            <td>${new Date().toLocaleTimeString()}</td>
        `;
    }

    function loadChart(symbol) {
        if (chartWidget) {
            chartWidget.setSymbol(symbol);
            return;
        }
        
        chartWidget = new TradingView.widget({
            "autosize": true,
            "symbol": symbol,
            "interval": "15",
            "timezone": "Etc/UTC",
            "theme": "dark",
            "style": "1",
            "locale": "en",
            "toolbar_bg": "#1e222d",
            "enable_publishing": false,
            "hide_side_toolbar": false,
            "container_id": "tradingview-widget-container"
        });
    }

    function deposit() {
        const amount = parseFloat(prompt("Enter deposit amount (minimum $1):", "1"));
        if (!isNaN(amount) && amount >= 1) {
            balance += amount;
            updateBalance();
            alert(`Successfully deposited $${amount.toFixed(2)}`);
        } else {
            alert("Minimum deposit amount is $1");
        }
    }

    function withdraw() {
        const amount = parseFloat(prompt("Enter withdrawal amount (minimum $1):", "1"));
        if (!isNaN(amount) && amount >= 1 && amount <= balance) {
            balance -= amount;
            updateBalance();
            alert(`Successfully withdrew $${amount.toFixed(2)}`);
        } else {
            alert("Invalid amount (minimum $1, maximum your balance)");
        }
    }

    function startTimer(seconds, callback) {
        secondsLeft = seconds;
        timerDisplay.textContent = `Timer: ${secondsLeft}s`;

        timerInterval = setInterval(() => {
            secondsLeft--;
            timerDisplay.textContent = `Timer: ${secondsLeft}s`;
            if (secondsLeft <= 0) {
                clearInterval(timerInterval);
                callback();
            }
        }, 1000);
    }

    function buy() {
        if (tradeRunning) return alert("Finish current trade first.");
        const stake = parseFloat(document.getElementById("trade-amount").value);
        if (!stake || stake < 10 || stake > balance) {
            return alert("Invalid amount (min $10, max your balance)");
        }

        currentStake = stake;
        balance -= stake;
        updateBalance();

        showProfitLoss("Trade running...", true);
        tradeRunning = true;

        startTimer(10, () => {
            profitOrLoss = Math.random() > 0.5 ? stake * 0.2 : -stake * 0.3;
            showProfitLoss(`Trade ready. You may Sell or Cancel now.`, profitOrLoss >= 0);
        });
    }

    function sell() {
        if (!tradeRunning) return alert("No trade to sell.");
        clearInterval(timerInterval);
        timerDisplay.textContent = "Timer: 0s";

        const result = currentStake + profitOrLoss;
        balance += result;
        updateBalance();

        const resultText = profitOrLoss >= 0 
            ? `Profit: $${profitOrLoss.toFixed(2)}`
            : `Loss: $${Math.abs(profitOrLoss).toFixed(2)}`;
        
        showProfitLoss(resultText, profitOrLoss >= 0);
        addHistory("Closed");

        currentStake = 0;
        profitOrLoss = 0;
        tradeRunning = false;
    }

    function cancelTrade() {
        if (!tradeRunning) return alert("No active trade to cancel.");
        clearInterval(timerInterval);
        timerDisplay.textContent = "Timer: 0s";

        if (profitOrLoss === 0) {
            balance += currentStake;
            showProfitLoss("Trade cancelled. Stake refunded.");
        } else {
            const result = currentStake + profitOrLoss;
            balance += result;
            showProfitLoss(
                profitOrLoss >= 0 
                    ? `Profit (on cancel): $${profitOrLoss.toFixed(2)}`
                    : `Loss (on cancel): $${Math.abs(profitOrLoss).toFixed(2)}`,
                profitOrLoss >= 0
            );
        }

        updateBalance();
        addHistory("Cancelled");
        currentStake = 0;
        profitOrLoss = 0;
        tradeRunning = false;
    }

    function closeAll() {
        if (!tradeRunning) return alert("No active trades");
        cancelTrade();
    }

    function resetAccount() {
        if (confirm("Reset account to $100,000? All history will be lost.")) {
            balance = 100000;
            tradeId = 1;
            document.getElementById("history-table").innerHTML = "";
            updateBalance();
            showProfitLoss("");
        }
    }

    // Initialize
    document.getElementById("crypto-select").addEventListener("change", function() {
        selectedSymbol = this.value;
        loadChart(selectedSymbol);
    });

    window.onload = () => {
        loadChart(selectedSymbol);
        updateBalance();
    };
</script>
</body>
</html>
